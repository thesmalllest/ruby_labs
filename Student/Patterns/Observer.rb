# –ö–ª–∞—Å—Å "–ò–∑–¥–∞—Ç–µ–ª—å" (Observable)
class NewsPublisher
  def initialize
    @observers = []  # –°–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ (–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π)
  end

  # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞
  def add_observer(observer)
    @observers << observer
  end

  # –£–¥–∞–ª—è–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞
  def remove_observer(observer)
    @observers.delete(observer)
  end

  # –£–≤–µ–¥–æ–º–ª—è–µ–º –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ –Ω–æ–≤–æ–π –Ω–æ–≤–æ—Å—Ç–∏
  def notify_observers(news)
    @observers.each { |observer| observer.update(news) }
  end

  # –ú–µ—Ç–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–∏
  def publish_news(news)
    puts "üì¢ –ù–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å: #{news}"
    notify_observers(news)  # –û–ø–æ–≤–µ—â–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
  end
end

# –ö–ª–∞—Å—Å "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å" (Observer)
class User
  def initialize(name)
    @name = name
  end

  # –ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
  def update(news)
    puts "üîî #{@name}, –≤–∞–º –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: '#{news}'"
  end
end

# --- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã ---

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª
news_portal = NewsPublisher.new

# –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π)
user1 = User.new("–ê–ª–∏—Å–∞")
user2 = User.new("–ë–æ–±")

# –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏
news_portal.add_observer(user1)
news_portal.add_observer(user2)

# –ü—É–±–ª–∏–∫—É–µ–º –Ω–æ–≤–æ—Å—Ç—å, –∏ –≤—Å–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
news_portal.publish_news("–†—É–±–∏ 4.0 –≤—ã—à–µ–ª –≤ —Ä–µ–ª–∏–∑!")

# –û—Ç–ø–∏—Å—ã–≤–∞–µ–º –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
news_portal.remove_observer(user2)

# –ü—É–±–ª–∏–∫—É–µ–º –µ—â–µ –æ–¥–Ω—É –Ω–æ–≤–æ—Å—Ç—å, —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ–¥–ø–∏—Å—á–∏–∫ –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
news_portal.publish_news("Rails 7.1 –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è!")
